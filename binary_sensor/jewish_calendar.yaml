###
# Jewish calendar
###
# Return True if it is fast today - but not at kippur as it is a holiday
- platform: template
  sensors:
    is_fast_day:
      friendly_name: 'צום'
      value_template: >-
        {{ state_attr('sensor.jewish_calendar_holiday', 'type_id') == 5 }}
      icon_template: >-
        {% if is_state('binary_sensor.is_fast_day', 'on') %}
          mdi:food-off
        {% else %}
          mdi:food
        {% endif %}

# Shabat notification trigger
# FIXME: These sensors have hardcoded timezone offset.
- platform: template
  sensors:
    shabat_notification_10m:
      friendly_name: 'Shabat 10 min Notification Trigger'
      value_template: >-
        {{
          as_timestamp(states('sensor.jewish_calendar_upcoming_candle_lighting')) |
          timestamp_custom('%H:%M:%S') == (now().strftime("%s") |
          float + (10*60) - (10800) ) |
          timestamp_custom("%H:%M:%S")
        }}
    shabat_notification_trigger_30m:
      friendly_name: 'Shabat Half hour Notification Trigger'
      value_template: >-
        {{
          as_timestamp(states('sensor.jewish_calendar_upcoming_candle_lighting')) |
          timestamp_custom('%H:%M:%S') == (now().strftime("%s") |
          float + (30*60) - (10800) ) |
          timestamp_custom("%H:%M:%S")
        }}
